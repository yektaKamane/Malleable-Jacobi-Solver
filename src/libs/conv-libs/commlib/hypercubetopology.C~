
#include "hypercubetopology.h"

inline int maxdim(int n)
{
  int maxpes=1, dim=0;

  while (maxpes< n) {
        maxpes *=2;
        dim++;
  }
  if (maxpes==n) return(dim);
  else return(dim-1);
}


HypercubeTopology::HypercubeTopology(int npes) {
    dim = maxdim(npes);
}

void HypercubeTopology::getNeighbors(int mype, int &npes, int *pelist){
    npes = dim;

    for(int count = dim - 1; count >= 0; count++)
        pelist[count] = pe ^ (1 << count);
}

int HypercubeTopology::getNumStages(){
    return dim;
}

int HypercubeTopology::getNumSteps(int stage) {
    return 1;
}

void HypercubeTopology::getPesToSend(int step, int stage, int &npesToSend, 
                                     int *pelist, int &nextpe) {
    
}

int HypercubeTopology::getNumMessagesExpected(int stage) {
}

