# Default charmc options 
# - changes to be passed in via simulation makefiles 
# **************************************************
CDIR=../../../..
CHARMINC=$(CDIR)/include
CHARMBIN=$(CDIR)/bin
CHARMC=$(CDIR)/bin/charmc $(OPTS)
POSEINCDIR = $(CHARMINC)/pose

# POSE object definitions - DO NOT MODIFY
#***********************************
OBJECTS=	eventID.o stats.o pose.o srtable.o cancel.o evmpool.o \
		pvtobj.o lbObject.o ldbal.o gvt.o event.o eqheap.o \
		evq.o sim.o rep.o strat.o cons.o opt.o adapt.o
LIB = libpose.a
LIBDEST =  $(CDIR)/lib/$(LIB)
CIFILES = evmpool.def.h  gvt.def.h  ldbal.def.h  pose.def.h  sim.def.h  stats.def.h  

# POSE LIBRARY GENERATION RULES -
# DO NOT MODIFY
# *******************************
$(LIBDEST):	$(OBJECTS)
	$(CHARMC) -o $(LIBDEST) $(OBJECTS) 
	test ! -d $(POSEINCDIR) && mkdir $(POSEINCDIR) || true
	/bin/cp -f  *.h $(POSEINCDIR)
	/bin/cp -f  etrans.pl $(CHARMBIN)

# POSE COMPILATION RULES 
# - DO NOT MODIFY
#***********************

sim.def.h : sim.decl.h

sim.decl.h : sim.ci
	$(CHARMC) sim.ci

gvt.def.h: gvt.decl.h

gvt.decl.h : gvt.ci
	$(CHARMC) gvt.ci

ldbal.def.h: ldbal.decl.h

ldbal.decl.h : ldbal.ci
	$(CHARMC) ldbal.ci

pose.def.h: pose.decl.h

pose.decl.h: pose.ci
	$(CHARMC) pose.ci

stats.def.h: stats.decl.h

stats.decl.h : stats.ci
	$(CHARMC) stats.ci

evmpool.def.h: evmpool.decl.h 

evmpool.decl.h: evmpool.ci
	$(CHARMC) evmpool.ci

# HOUSE-KEEPING RULES
#********************
clean:
	rm -f charmrun conv-host *.o
	rm -f *.def.h *.decl.h
	rm -f gmon.out #*#
	rm -f core *~
	rm -f TAGS *.headers
	rm -f libpose.a

include Make.depends

DEPENDFILE = Make.depends

depends:  $(CIFILES)
	echo "Creating " $(DEPENDFILE) " ..."; 	\
	if [ -f $(DEPENDFILE) ]; then \
           /bin/cp -f $(DEPENDFILE) $(DEPENDFILE).old; \
        fi; \
	echo '#generated by make depends' > $(DEPENDFILE); \
        for i in $(OBJECTS) ; do \
	      SRCFILE=`basename $$i .o`.C ; \
              echo "checking dependencies for $$SRCFILE" ; \
              g++ -MM -Wno-deprecated -I$(CHARMINC) $$SRCFILE >> $(DEPENDFILE); \
              echo '	$$(CHARMC) -o '$$i $$SRCFILE >> $(DEPENDFILE) ; \
        done; 

